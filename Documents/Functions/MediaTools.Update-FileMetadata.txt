ğŸ“ MediaTools.Update-FileMetadata Function Documentation

Function:
Update-FileMetadata

Description:
Updates the file's timestamp and geotag metadata fields in-place using ExifTool for images or FFmpeg for videos, based on a unified metadata input.

Input Type:
1. $filePath [string] â€” Full path to the media file (image or video)
2. $metadata [hashtable] â€” Metadata fields to write:
      - TimeStamp (optional)
      - Latitude (optional)
      - Longitude (optional)
3. $logFunc [scriptblock] â€” Logging callback to track success/failure (optional)

Output Type:
âœ… [void] â€” Metadata written successfully to file
âŒ Logs warning/error if write fails; does not throw

Algorithm (Pseudo-code):
1. Determine File Type
   a. Use MediaTools.is_photo and MediaTools.is_video to check extension

2. If image:
   a. If TimeStamp â†’ Call MediaTools.Write_TimeStamp
   b. If Geotag â†’ Call MediaTools.Write_Geotag

3. If video:
   a. If TimeStamp or Geotag present:
      - Call MediaTools.Write_TimeStamp (ffmpeg-based)
      - Call MediaTools.Write_Geotag (ffmpeg-based)

4. Logging:
   a. If write successful â†’ log success
   b. If write fails â†’ log warning

Function Calls:
ğŸ”¹ MediaTools.is_photo â€” Checks if file is an image
ğŸ”¹ MediaTools.is_video â€” Checks if file is a video
ğŸ”¹ MediaTools.Write_TimeStamp â€” Writes timestamp using appropriate tool
ğŸ”¹ MediaTools.Write_Geotag â€” Writes geotag using appropriate tool

Possible Issues:
âœ… Covered: Selects method based on file extension
âœ… Covered: Logs each write attempt
âœ… Covered: Skips null metadata fields
âŒ Not Covered: Conflicting or malformed metadata input
âŒ Not Covered: Media file write-protected or locked
âŒ Not Covered: Non-standard or unsupported media format
