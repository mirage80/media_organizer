📝 MediaTools.Update-FileMetadata Function Documentation

Function:
Update-FileMetadata

Description:
Updates the file's timestamp and geotag metadata fields in-place using ExifTool for images or FFmpeg for videos, based on a unified metadata input.

Input Type:
1. $filePath [string] — Full path to the media file (image or video)
2. $metadata [hashtable] — Metadata fields to write:
      - TimeStamp (optional)
      - Latitude (optional)
      - Longitude (optional)
3. $logFunc [scriptblock] — Logging callback to track success/failure (optional)

Output Type:
✅ [void] — Metadata written successfully to file
❌ Logs warning/error if write fails; does not throw

Algorithm (Pseudo-code):
1. Determine File Type
   a. Use MediaTools.is_photo and MediaTools.is_video to check extension

2. If image:
   a. If TimeStamp → Call MediaTools.Write_TimeStamp
   b. If Geotag → Call MediaTools.Write_Geotag

3. If video:
   a. If TimeStamp or Geotag present:
      - Call MediaTools.Write_TimeStamp (ffmpeg-based)
      - Call MediaTools.Write_Geotag (ffmpeg-based)

4. Logging:
   a. If write successful → log success
   b. If write fails → log warning

Function Calls:
🔹 MediaTools.is_photo — Checks if file is an image
🔹 MediaTools.is_video — Checks if file is a video
🔹 MediaTools.Write_TimeStamp — Writes timestamp using appropriate tool
🔹 MediaTools.Write_Geotag — Writes geotag using appropriate tool

Possible Issues:
✅ Covered: Selects method based on file extension
✅ Covered: Logs each write attempt
✅ Covered: Skips null metadata fields
❌ Not Covered: Conflicting or malformed metadata input
❌ Not Covered: Media file write-protected or locked
❌ Not Covered: Non-standard or unsupported media format
