📍 MediaTools.Set-Geotag Function Documentation

Function:
Set-Geotag

Description:
Writes a standardized 4-part geotag string to the appropriate GPS fields in a media file using ExifTool.

Input Type:

1. File [System.IO.FileInfo] (Mandatory) — The media file to write to.
2. GeoTag [string] (Mandatory) — The standardized 4-part geotag string to write (e.g., `"40.7128,N,74.0060,W"`).
3. TimeoutSeconds [int] (Optional, Default: 60) — The timeout to pass down to the underlying ExifTool process.

Output Type:

✅ [void] — This function does not return a value.
❌ Throws an exception if the input geotag is invalid or if the underlying ExifTool command fails.

Algorithm (Pseudo-code):

1. Validate that the input `File` exists and that the `GeoTag` is valid using `Test-GeoTag`.
2. Parse the 4-part `GeoTag` string into its components (latitude, latRef, longitude, lonRef).
3. Construct the ExifTool arguments array using the individual GPS tags: `-GPSLatitude`, `-GPSLatitudeRef`, `-GPSLongitude`, and `-GPSLongitudeRef`. The numeric values are passed as positive numbers.
4. Add the `-overwrite_original` argument to prevent ExifTool from creating backup files.
5. Call `Invoke-ExifTool` with the arguments, file, and timeout to execute the write operation.

Function Calls:

🔹 Test-GeoTag
🔹 Invoke-ExifTool

Possible Issues:

* ✅ Covered: Ensures the input geotag is valid before attempting to write.
* ✅ Covered: Correctly constructs the ExifTool arguments to write all four GPS components.
* ✅ Covered: Delegates the actual write operation to the robust, caching `Invoke-ExifTool` function.
