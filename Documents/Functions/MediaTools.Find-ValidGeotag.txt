ğŸ—ºï¸ MediaTools.Find-ValidGeotag Function Documentation

Function:
Find-ValidGeotag

Description:
Searches a metadata hashtable for the first valid geotag and returns it in standardized decimal format.

Input Type:
1. $metadata [hashtable] â€” A hashtable containing geolocation-related metadata from various sources

Output Type:
âœ… [hashtable] â€” Contains standardized "Latitude" and "Longitude" keys with decimal values
âŒ [null] â€” If no valid geotag is found or input is invalid

Algorithm (Pseudo-code):
1. If $metadata is null or empty
   â†’ Return null

2. Define list of known geotag fields to check (e.g., GPSLatitude, GPSLongitude, Location, etc.)

3. For each candidate field or combination:
   3.1 Extract potential latitude and longitude
   3.2 Call IsValid_GeoTag on the pair
       â†’ If valid:
           a. Standardize using Standardize_GeoTag
           b. Return as hashtable: @{ Latitude = ..., Longitude = ... }

4. If no valid geotag found after all checks:
   â†’ Return null

Function Calls:
ğŸ”¹ MediaTools.IsValid_GeoTag â€” Validates latitude/longitude values
ğŸ”¹ MediaTools.Standardize_GeoTag â€” Converts raw formats (DMS, ref-based) to decimal degrees

Possible Issues:
âœ… Covered: Missing or malformed fields
âœ… Covered: Non-decimal formats (e.g., DMS with N/S/E/W refs)
âŒ Not Covered: Nested or encoded geolocation fields
âŒ Not Covered: Conflicting GPS sources in metadata
âŒ Not Covered: Geotags with only one coordinate (lat or lon)
