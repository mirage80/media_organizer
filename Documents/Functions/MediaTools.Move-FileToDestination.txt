ğŸ“‚ MediaTools.Move-FileToDestination Function Documentation

Function:
Move-FileToDestination

Description:
Moves a media file to a destination path, creating directories if necessary and optionally overwriting existing files.

Input Type:
1. $source [string] â€” Full path to the file to be moved
2. $destination [string] â€” Full destination file path
3. $logFunc [scriptblock] â€” Optional logger callback to track operations
4. $overwrite [bool] â€” Whether to overwrite existing file (default: $false)

Output Type:
âœ… [void] â€” File moved to destination
âŒ Logs an error if file move fails

Algorithm (Pseudo-code):
1. Validate Paths
   a. If $source does not exist â†’ log error, return
   b. If $destination's directory does not exist â†’ create it

2. Handle Overwrite
   a. If $overwrite is $true and destination exists â†’ delete it

3. Attempt Move
   a. Use Move-Item to move $source to $destination
   b. Catch exceptions â†’ log warning

4. Logging
   a. If move successful â†’ log info
   b. If move fails â†’ log error

Function Calls:
ğŸ”¹ Move-Item â€” Performs the file move
ğŸ”¹ Test-Path â€” Validates file and directory existence
ğŸ”¹ New-Item -ItemType Directory â€” Creates target folder if missing
ğŸ”¹ Remove-Item â€” Deletes target file if overwriting

Possible Issues:
âœ… Covered: Creates directory if missing
âœ… Covered: Optional overwrite logic
âœ… Covered: Logs both success and failure
âŒ Not Covered: Race conditions in concurrent moves
âŒ Not Covered: Permissions issues (read-only or locked files)
âŒ Not Covered: Invalid characters in path names
