ğŸ“ Utils.Write-Log Function Documentation

Function:
Utils.Write-Log

Description:
Writes a formatted log message to both console and log file with a timestamp and log level prefix.

Input Type:
1. Message [string] â€” The log message content
2. Level [string] â€” Log severity: "DEBUG", "INFO", "WARNING", or "ERROR"

Output Type:
âœ… [void] â€” Message is written to output streams
âŒ If logging fails (e.g., file write error), the failure is silently ignored

Algorithm (Pseudo-code):
1. Validate Inputs
   1.1 If Message is null or empty â†’ return early
   1.2 If Level not in known set â†’ default to "INFO"

2. Create Timestamped Message
   2.1 Format: "YYYY-MM-DD HH:MM:SS - LEVEL: Message"

3. Write to Console
   3.1 If Level is "ERROR" or "WARNING" â†’ write to standard error stream
   3.2 Else â†’ write to standard output

4. Write to Log File
   4.1 If $Global:LogFilePath is set
       4.1.1 Append formatted message to file
       4.1.2 If file write fails, do nothing

Function Calls:
None

Possible Issues:
âœ… Covered: Null or empty message
âœ… Covered: Invalid log level fallback
âœ… Covered: Distinct handling for stdout vs stderr
âœ… Covered: No log file path fallback
âŒ Not Covered: File permission/locking issues during write
âŒ Not Covered: Extremely large messages
âŒ Not Covered: Simultaneous writes from other processes