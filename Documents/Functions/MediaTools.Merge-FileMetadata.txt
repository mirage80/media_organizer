🔗 MediaTools.Merge-FileMetadata Function Documentation

Function:
Merge-FileMetadata

Description:
Consolidates timestamp and geotag metadata from multiple sources (Exif, ffprobe, JSON) into a unified structure by selecting the most valid and precise values.

Input Type:
1. $allMetadata [hashtable] — Contains nested metadata grouped by source:
      - Exif
      - Ffprobe
      - Json
   Each source may contain:
      - Timestamp
      - Geotag (Latitude, Longitude)

Output Type:
✅ [hashtable] — Consolidated metadata with keys:
      - TimeStamp
      - Latitude
      - Longitude
      - SourceTimeStamp
      - SourceGeotag
❌ [null] — If no metadata is found across all sources

Algorithm (Pseudo-code):
1. Initialize result hashtable

2. Determine Best Timestamp
   a. Try Exif.Timestamp → If valid, use it
   b. Else try Json.Timestamp
   c. Else try Ffprobe.Timestamp
   d. Use MediaTools.IsValid_TimeStamp to validate
   e. If selected, update result[TimeStamp] and result[SourceTimeStamp]

3. Determine Best Geotag
   a. Try Exif.Latitude/Longitude → If valid, use them
   b. Else try Json
   c. Else try Ffprobe
   d. Use MediaTools.IsValid_GeoTag to validate
   e. If selected, update result[Latitude], result[Longitude], and result[SourceGeotag]

4. Return result hashtable (if at least one valid field found)

Function Calls:
🔹 MediaTools.IsValid_TimeStamp — Validates timestamp format
🔹 MediaTools.IsValid_GeoTag — Validates latitude and longitude fields

Possible Issues:
✅ Covered: Missing metadata fields in one or more sources
✅ Covered: Validity checking for geotag and timestamp
✅ Covered: Tracks metadata origin (Exif, Json, Ffprobe)
❌ Not Covered: Conflicts between equally valid values from different sources
❌ Not Covered: Timezone normalization between sources
❌ Not Covered: GPS format discrepancies (DMS vs decimal)
