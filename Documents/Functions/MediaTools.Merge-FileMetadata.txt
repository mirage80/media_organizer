ğŸ”— MediaTools.Merge-FileMetadata Function Documentation

Function:
Merge-FileMetadata

Description:
Consolidates timestamp and geotag metadata from multiple sources (Exif, ffprobe, JSON) into a unified structure by selecting the most valid and precise values.

Input Type:
1. $allMetadata [hashtable] â€” Contains nested metadata grouped by source:
      - Exif
      - Ffprobe
      - Json
   Each source may contain:
      - Timestamp
      - Geotag (Latitude, Longitude)

Output Type:
âœ… [hashtable] â€” Consolidated metadata with keys:
      - TimeStamp
      - Latitude
      - Longitude
      - SourceTimeStamp
      - SourceGeotag
âŒ [null] â€” If no metadata is found across all sources

Algorithm (Pseudo-code):
1. Initialize result hashtable

2. Determine Best Timestamp
   a. Try Exif.Timestamp â†’ If valid, use it
   b. Else try Json.Timestamp
   c. Else try Ffprobe.Timestamp
   d. Use MediaTools.IsValid_TimeStamp to validate
   e. If selected, update result[TimeStamp] and result[SourceTimeStamp]

3. Determine Best Geotag
   a. Try Exif.Latitude/Longitude â†’ If valid, use them
   b. Else try Json
   c. Else try Ffprobe
   d. Use MediaTools.IsValid_GeoTag to validate
   e. If selected, update result[Latitude], result[Longitude], and result[SourceGeotag]

4. Return result hashtable (if at least one valid field found)

Function Calls:
ğŸ”¹ MediaTools.IsValid_TimeStamp â€” Validates timestamp format
ğŸ”¹ MediaTools.IsValid_GeoTag â€” Validates latitude and longitude fields

Possible Issues:
âœ… Covered: Missing metadata fields in one or more sources
âœ… Covered: Validity checking for geotag and timestamp
âœ… Covered: Tracks metadata origin (Exif, Json, Ffprobe)
âŒ Not Covered: Conflicts between equally valid values from different sources
âŒ Not Covered: Timezone normalization between sources
âŒ Not Covered: GPS format discrepancies (DMS vs decimal)
