ğŸ“ MediaTools.categorize_bulk_media_based_on_metadata_keep_directory_structure Function Documentation

Function:
categorize_bulk_media_based_on_metadata_keep_directory_structure

Description:
Categorizes media files by timestamp and geolocation metadata, preserving the original directory structure under the destination. Moves files accordingly.

Input Type:
1. $files [string[]] â€” List of media file paths to process
2. $metadataJson [hashtable] â€” Metadata lookup per file, including timestamp/geotag
3. $destination [string] â€” Root directory for categorized output
4. $logFunc [scriptblock] â€” Logger callback for tracking actions
5. $keepOriginal [bool] â€” Whether to preserve original files (default: $false)

Output Type:
âœ… [void] â€” Files are moved into categorized folders
âŒ Logs warnings or errors for skipped or failed moves

Algorithm (Pseudo-code):
1. For each $file in $files:
   a. If $metadataJson does not contain $file â†’ log and skip
   b. Extract timestamp and geotag from $metadataJson[$file]

2. Determine Target Directory
   a. If timestamp is valid â†’ format as yyyy\yyyy-MM\yyyy-MM-dd
   b. If geotag is valid â†’ append GPS_Lat_Lon directory
   c. Else â†’ fallback to â€œUncategorizedâ€

3. Construct Full Destination Path
   a. Combine $destination with derived structure
   b. Ensure subdirectory exists

4. Move or Copy File
   a. If $keepOriginal is $true â†’ copy file
   b. Else â†’ move file
   c. Log success or failure

Function Calls:
ğŸ”¹ MediaTools.IsValid_TimeStamp â€” Validates timestamp
ğŸ”¹ MediaTools.IsValid_GeoTag â€” Validates geolocation
ğŸ”¹ MediaTools.Move-FileToDestination â€” Performs actual file move
ğŸ”¹ MediaTools.Format-Timestamp â€” Formats timestamp into folder structure
ğŸ”¹ MediaTools.Standardize_GeoTag â€” Standardizes and formats GPS string

Possible Issues:
âœ… Covered: Skips files with no metadata
âœ… Covered: Preserves directory structure under categorized root
âœ… Covered: Can choose between copy and move
âŒ Not Covered: Collisions if files share the same timestamp/geotag
âŒ Not Covered: Invalid metadata structure in $metadataJson
âŒ Not Covered: No deduplication or conflict resolution in destination
