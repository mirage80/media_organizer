ğŸ•’ MediaTools.Standardize_TimeStamp Function Documentation

Function:
Standardize_TimeStamp

Description:
Normalizes various timestamp formats into a consistent pipeline format: "yyyy:MM:dd HH:mm:ss+00:00"

Input Type:
1. $timestamp [string] â€” Raw timestamp string from metadata

Output Type:
âœ… [string] â€” Standardized timestamp in UTC ISO format
âŒ [null] â€” If the timestamp is missing or invalid

Algorithm (Pseudo-code):
1. If $timestamp is null or empty
   â†’ Return null

2. Remove unwanted characters (e.g., enclosing quotes, trailing whitespace)

3. Detect common formats:
   a. ISO8601: 2023-12-01T15:30:00Z
   b. EXIF:   2023:12:01 15:30:00
   c. Custom: 2023/12/01 15:30, etc.

4. Parse using Get-Date or custom regex
   â†’ If parse succeeds:
       a. Convert to UTC
       b. Format as "yyyy:MM:dd HH:mm:ss+00:00"
       c. Return result

5. If parse fails:
   â†’ Return null

Function Calls:
ğŸ”¹ MediaTools.Parse_DateTimeFromFilename â€” Attempts parsing timestamps from filenames
ğŸ”¹ Get-Date â€” Used to parse and format standard timestamps

Possible Issues:
âœ… Covered: EXIF and ISO timestamp patterns
âœ… Covered: Extra characters and whitespace
âŒ Not Covered: Locale-dependent formats (e.g., MM/DD/YYYY)
âŒ Not Covered: Inconsistent or partial timestamps (missing seconds or year)
âŒ Not Covered: Conflicting timezones without standard suffix
