ğŸ“„ Function: 
Utils.Write-JsonAtomic

ğŸ“ Description:
Safely writes a PowerShell object to a JSON file using atomic replacement. Prevents partial writes by writing to a temporary file and renaming it into place after success.

ğŸ”¢ Input Type:
1. `object` [object] â€” PowerShell object to serialize to JSON
2. `path` [string] â€” Target file path for final JSON file

ğŸ“¤ Output Type:
âœ… [void] â€” Writes JSON to the target file safely
âŒ Logs an error if writing or renaming fails; original file remains untouched

ğŸ§® Algorithm (Pseudo-code):
1. Validate Input
â€ƒ1.1 If `object` is `$null` â†’ log warning, return
â€ƒ1.2 If `path` is `$null` or empty â†’ log error, return

2. Serialize JSON
â€ƒ2.1 Call `ConvertTo-Json` on `object` with indentation

3. Write to Temporary File
â€ƒ3.1 Generate a temp path using the same directory and `.tmp` extension
â€ƒ3.2 Try to write the serialized JSON to temp file using `Set-Content`

4. Atomic Replace
â€ƒ4.1 If temp file written successfully
â€ƒâ€ƒâ€ƒ4.1.1 Use `Move-Item -Force` to rename temp file over original
â€ƒâ€ƒâ€ƒ4.1.2 Log success
â€ƒ4.2 Else
â€ƒâ€ƒâ€ƒ4.2.1 Log error and skip rename

ğŸ“ Function Calls:
ğŸ”¹ Utils.Write-Log â€” Log errors, warnings, and success messages

âš ï¸ Not yet documented; recheck later

â— Possible Issues:
âœ… Covered: Null input object
âœ… Covered: Empty or invalid file path
âœ… Covered: Temporary file creation failure
âœ… Covered: Atomic rename logic
âŒ Not Covered: File permission errors (e.g., write-protected directory)
âŒ Not Covered: JSON serialization edge cases (e.g., circular references)
âŒ Not Covered: Race conditions with simultaneous writers